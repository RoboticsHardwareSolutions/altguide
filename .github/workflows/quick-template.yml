name: Quick Template Download

on:
  workflow_dispatch:
    inputs:
      template_name:
        description: 'Template name (e.g., MyProject)'
        required: false
        default: 'rhs-altium-template'
        type: string

jobs:
  create-quick-template:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 1
          sparse-checkout: |
            template
          sparse-checkout-cone-mode: false
        
      - name: Get current date
        id: date
        run: echo "date=$(date +'%Y%m%d-%H%M')" >> $GITHUB_OUTPUT
        
      - name: Create template directory
        run: |
          mkdir -p "${{ inputs.template_name }}"
          
      - name: Copy template files
        run: |
          # Copy all files from template directory
          cp -r template/* "${{ inputs.template_name }}/"
          
      - name: Create template archive
        run: |
          zip -r "${{ inputs.template_name }}-${{ steps.date.outputs.date }}.zip" "${{ inputs.template_name }}/"
          
      - name: Upload template artifact
        uses: actions/upload-artifact@v4
        with:
          name: ${{ inputs.template_name }}-${{ steps.date.outputs.date }}
          path: ${{ inputs.template_name }}-${{ steps.date.outputs.date }}.zip
          retention-days: 1
          
      - name: Add download link to summary
        run: |
          echo "## ðŸ“¦ Template Created Successfully!" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Template Name:** ${{ inputs.template_name }}-${{ steps.date.outputs.date }}" >> $GITHUB_STEP_SUMMARY
          echo "**Project Name:** ${{ inputs.template_name }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ“¥ Download:" >> $GITHUB_STEP_SUMMARY
          echo "**GitHub Artifacts:** Check the 'Artifacts' section below to download the template" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ”§ Contents:" >> $GITHUB_STEP_SUMMARY
          echo "- Altium PCB template" >> $GITHUB_STEP_SUMMARY
          echo "- GitHub Actions workflows" >> $GITHUB_STEP_SUMMARY  
          echo "- Documentation templates" >> $GITHUB_STEP_SUMMARY
          echo "- Board options and BOM templates" >> $GITHUB_STEP_SUMMARY
